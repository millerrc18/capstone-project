<div class="auth-shell">
  <div class="auth-card">
    <div class="auth-header">
      <h1>Import costs</h1>
      <p class="subtle">
        Upload the Costs template (.xlsx). Costs can be weekly or monthly.
        <% if @contract.blank? %>
          Include a contract_code for each row to import multiple contracts at once.
        <% end %>
      </p>
    </div>

    <%= form_with url: (@contract.present? ? contract_cost_imports_path(@contract) : program_cost_imports_path(@program)),
                  local: true,
                  multipart: true,
                  class: "form" do |f| %>
      <div class="field">
        <%= f.label :file, "Excel file" %>
        <%= f.file_field :file, class: "input", accept: ".xlsx" %>
        <p class="hint">
          Tip: period_type must be week or month.
          <% if @contract.blank? %>
            contract_code is required for each row.
          <% end %>
        </p>
      </div>

      <div class="form-actions">
        <%= f.submit "Import", class: "btn btn-primary btn-block" %>
        <%= link_to "Cancel",
                    (@contract.present? ? contract_path(@contract) : program_path(@program)),
                    class: "btn btn-block" %>
      </div>
    <% end %>
  </div>
</div>
